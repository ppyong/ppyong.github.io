---
layout: post
title: JPA 정리
---

## 영속성 컨텍스트

> 엔티티를 영구 저장하는 환경이라는 뜻. 엔티티 매니저를 생성할 때 하나 만들어지고, 매니저를 통해서 영속성 컨텍스트에 접근할 수 있다. 

## 엔티티 생명 주기 

- 비영속(new/transient)

>  엔티티 객체를 생성 후 아직 저장하지 않은 상태. 영속성 컨텍스트나 데이터베이스와는 전혀 관련이 없음

- 영속(managed)

> 엔티티 매니저를 통해서 엔티티를 영속성 컨텍스트에 저장했다. 영속성 컨텍스트가 관리하는 상태
> em.find() 나 JPQL을 사용해 조회한 엔티티도 영속성 컨텍스트가 관리하는 영속 상태 
> 영속 상태는 식별자 값이 반드시 있어야 한다 

- 준영속(detached)

> 영속성 컨텍스트가 관리하던 영속 상태의 엔티티를 영속성 컨텍스트가 관리하지 않으면 준영속 상태가 된다. 
> em.close(), em.detach(), em.clear() 를 호출해서 영속성 컨텍스트를 초기화해도 영속성 컨테스트가 관라헌 영속 상태의 엔티티는 준영속 상태가 된다. 

> - 거의 영속화 상태에 가깝다. 
> 1차 캐시, 쓰기 지연, 변경 감지, 지연 로딩 등 영속성 컨텍스트가 제공하는 어떠한 기능도 동작하지 않는다.
> - 식별자 값을 가지고 있다. 
> - 지연 로딩을 할 수 없다. 

- 삭제 (removed)

> 엔티티를 영속성 컨텍스트와 데이터베이스에서 삭제한다. 
